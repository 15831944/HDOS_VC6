<html>
<head>
<title>TEST</title>
<OBJECT   classid="clsid:A2224632-AAC9-4715-8476-E337F8C6E8AF" width=0 height=0 align="center" codebase="HD_CPUAndID.ocx"  id="HD_CPUAndID" HSPACE=0 VSPACE=0>
</OBJECT>
<script language="javascript">

function mytest()
{	
//alert("haha");
	var str1;
	str1=HD_HNOCX.OpenDev("test","111111");
	alert(str1);
	str1=CloseDev();
//	var obj1 = document.getElementById('CardNo');
//	obj1.value = str1;
//	alert(str1);
}
function CloseDev()
{	
	var str1;
	str1=HD_HNOCX.CloseDev();
}
function HD_ReadCard()
{	
	var str1;
	var para=document.getElementById('para').value;
	var pin=document.getElementById('pin').value;
	var rd=document.getElementById('HD_HNOCX');
	str1=rd.ReadCard(para,'test','111111','1','222222',pin);
	
	//alert(rd.zp);
	
	var obj1=document.getElementById('CardNo');
	obj1.value=str1;
	if(para=='102')
	{
		document.getElementById("piccode").innerHTML = "<img style='width: 80px; height: 100px' src='data:;base64,"+ rd.zp + "' />";
	}
}
function HD_WriteCard()
{	
	var str1;
	var para=document.getElementById('para').value;
	var pin=document.getElementById('pin').value;
	var dataIn=document.getElementById('dataIn').value;
	str1=HD_HNOCX.WriteCard(para,dataIn,'test','111111','1','222222',pin);
	var obj1=document.getElementById('dataIn');
	obj1.value=str1;
}
function openDeivce_onclick()
{
	var rt=HD_CPUAndID.ReaderOpen();
	document.all['dispinfo'].value = document.all['dispinfo'].value +rt + "\r\n"
}
function closeDevice_onclick()
{
	var rt=HD_CPUAndID.ReaderClose();
	document.all['dispinfo'].value = document.all['dispinfo'].value +"关闭设备成功" + "\r\n"
}
function ExcAPDU_onclick()
{
	var CommandAPDU=document.getElementById('CommandAPDU').value;
	var rt=HD_CPUAndID.ICCReaderApplicationHEX(CommandAPDU);
	document.all['dispinfo'].value = document.all['dispinfo'].value +rt+ "\r\n"
}
function PowerOn_onclick()
{
	var rt=HD_CPUAndID.ICCPowerOn();
	document.all['dispinfo'].value = document.all['dispinfo'].value +rt+ "\r\n"
}
function PowerOff_onclick()
{
	var rt=HD_CPUAndID.ICCPowerOff();
	document.all['dispinfo'].value = document.all['dispinfo'].value +rt+ "\r\n"
}
function ReadID_onclick()
{
	var PicPath=document.getElementById('PicPath').value;
	var rt=HD_CPUAndID.ReadIDCard(PicPath);
	document.all['dispinfo'].value = document.all['dispinfo'].value +rt+ "\r\n"
}
</script>
</head> 

<body>
<textarea name="dispinfo" cols="100" rows="15"></textarea>
<p></p>
<input name="openDeivce" id="openDeivce" type="button" value="打开设备" onClick="return openDeivce_onclick()" />
<input name="closeDevice" id="closeDevice" type="button" value="关闭设备" onClick="return closeDevice_onclick()" />
<input name="PowerOn" id="PowerOn" type="button" value="上电" onClick="return PowerOn_onclick()" />
<input name="PowerOff" id="PowerOff" type="button" value="下电" onClick="return PowerOff_onclick()" />
<p></p>
指令:<input  type="text"  style="width:300px" id="CommandAPDU">
<input name="ExcAPDU" id="ExcAPDU" type="button" value="执行指令" onClick="return ExcAPDU_onclick()" />
<p></p>
照片路径:<input  type="text"  style="width:268px" id="PicPath" value="D:/zzp.bmp">
<input name="closeDevice" id="closeDevice" type="button" value="读身份证" onClick="return ReadID_onclick()" />
</body>
</html>